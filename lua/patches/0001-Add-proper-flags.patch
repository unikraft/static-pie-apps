From 3f3cbc3c3afed777fbf3bff12474321bb09c0872 Mon Sep 17 00:00:00 2001
From: Ismana Robert <robert.mihai018@gmail.com>
Date: Sat, 10 Sep 2022 18:17:38 +0300
Subject: [PATCH] Add proper flags

Signed-off-by: Ismana Robert <robert.mihai018@gmail.com>
---
 Makefile | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/Makefile b/Makefile
index 1907381..e5f9967 100644
--- a/Makefile
+++ b/Makefile
@@ -9,7 +9,7 @@ PLAT= guess
 CC= gcc -std=gnu99
 CFLAGS= -O2 -Wall -Wextra -DLUA_COMPAT_5_3 $(SYSCFLAGS) $(MYCFLAGS)
 LDFLAGS= $(SYSLDFLAGS) $(MYLDFLAGS)
-LIBS= -lm $(SYSLIBS) $(MYLIBS)
+LIBS= -ldl -lm $(SYSLIBS) $(MYLIBS)
 
 AR= ar rcu
 RANLIB= ranlib
@@ -21,7 +21,7 @@ SYSLDFLAGS=
 SYSLIBS=
 
 MYCFLAGS=
-MYLDFLAGS=
+MYLDFLAGS= -static-pie
 MYLIBS=
 MYOBJS=
 
@@ -120,7 +120,7 @@ generic: $(ALL)
 Linux linux:	linux-noreadline
 
 linux-noreadline:
-	$(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_LINUX" SYSLIBS="-Wl,-E -ldl"
+	$(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_LINUX" SYSLIBS=""
 
 linux-readline:
 	$(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_LINUX -DLUA_USE_READLINE" SYSLIBS="-Wl,-E -ldl -lreadline"
-- 
2.34.1

